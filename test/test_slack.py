import unittest

from ml_models.slack_search import get_ind


class TestSlack(unittest.TestCase):
    def test_one_id(self):
        matches = [{'iid': '409a7be8-a3f6-44fd-bc2a-c92c559a0f6b', 'team': 'T040HKJE3','channel': {'id': 'C04N3UMSL', 'is_channel': True, 'is_group': False, 'is_im': False, 'name': 'nlp','is_shared': False, 'is_org_shared': False, 'is_ext_shared': False, 'is_private': False,'is_mpim': False, 'pending_shared': [], 'is_pending_ext_shared': False},'type': 'message','user': 'U8TDZ6856', 'username': 's_kolomiyets', 'ts': '1574333171.343200', 'blocks': [{'type': 'rich_text', 'block_id': 'L6Rp', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text','text': 'Правильно ли я понимаю, если мы используем BPE-encoding, SentencePiece или YouTokenToMe, мы не можем генерировать ngrams?'}]}]}],'text': 'Правильно ли я понимаю, если мы используем BPE-encoding, SentencePiece или YouTokenToMe, мы не можем генерировать ngrams?','permalink': 'https://opendatascience.slack.com/archives/C04N3UMSL/p1574333171343200?thread_ts=1574333171.343200','no_reactions': True}]
        ind_list = [get_ind(match) for match in matches]
        self.assertEqual(ind_list, ['U8TDZ6856_1574333171.0'])

    def test_none_id(self):
        matches = []
        ind_list = [get_ind(match) for match in matches]
        self.assertEqual(ind_list, [])

    def test_several_id(self):
        matches = [{'iid': 'bebe385e-268f-40a1-ab0b-ceba91c05272', 'team': 'T040HKJE3', 'channel': {'id': 'C04DA5FUF', 'is_channel': True, 'is_group': False, 'is_im': False, 'name': '_jobs', 'is_shared': False, 'is_org_shared': False, 'is_ext_shared': False, 'is_private': False, 'is_mpim': False, 'pending_shared': [], 'is_pending_ext_shared': False}, 'type': 'message', 'user': 'UED0HP6KG', 'username': 'alexanderlitvintsev', 'ts': '1612386189.298500', 'blocks': [{'type': 'rich_text', 'block_id': 'y8Y', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Всем привет!\n'}, {'type': 'text', 'text': 'Компания:', 'style': {'bold': True}}, {'type': 'text', 'text': '\xa0Сбер\xa0'}, {'type': 'emoji', 'name': 'sber_new'}, {'type': 'text', 'text': ', Управление моделирования и исследования данных Блока Сеть продаж\n'}, {'type': 'text', 'text': 'Позиция:', 'style': {'bold': True}}, {'type': 'text', 'text': '\xa0Data Scientist\n'}, {'type': 'text', 'text': 'Уровень:', 'style': {'bold': True}}, {'type': 'text', 'text': '\xa0Middle / Senior\n'}, {'type': 'text', 'text': 'Вилка:', 'style': {'bold': True}}, {'type': 'text', 'text': '\xa0150-250 gross + годовая премия (x4-x9 окладов)\n'}, {'type': 'text', 'text': 'Место:', 'style': {'bold': True}}, {'type': 'text', 'text': '\xa0Москва\xa0'}, {'type': 'emoji', 'name': 'default-city'}, {'type': 'text', 'text': ', м. Кутузовская\n\nВам предстоит заниматься анализом геоданных, профилей клиентов, данных по транзакциям клиентов в системах Банка в масштабах всей страны, разрабатывать модели развития сети отделений и банкоматов, прогнозирования оттока клиентов и др.\n'}, {'type': 'text', 'text': '\xa0', 'style': {'bold': True}}, {'type': 'text', 'text': '\n'}, {'type': 'text', 'text': 'Задачи', 'style': {'bold': True}}, {'type': 'text', 'text': ':\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'проверка гипотез, проведение А/В тестирования'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'работа с геоданными, данными по транзакциям клиентов'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'разработка ML-моделей'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'участие в валидации модели'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'доработка модели на основании фактических результатов пилота'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'перевод модели в production'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Требования:', 'style': {'bold': True}}, {'type': 'text', 'text': '\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'понимание принципов работы алгоритмов машинного обучения (линейная регрессия, логистическая регрессия, деревья решений, случайный лес, градиентный бустинг)'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'понимание математической статистики'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'опыт разработки в ML-проектах'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'уверенное владение SQL\xa0'}, {'type': 'emoji', 'name': 'sql'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'опыт работы с sklearn\xa0'}, {'type': 'emoji', 'name': 'sklearn'}, {'type': 'text', 'text': ', pandas, numpy, scipy, matplotlib'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'уверенное владение python\xa0'}, {'type': 'emoji', 'name': 'python'}, {'type': 'text', 'text': ', ООП, git\xa0'}, {'type': 'emoji', 'name': 'git'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Будет плюсом:', 'style': {'bold': True}}, {'type': 'text', 'text': '\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'знание Deep Learning, oпыт работы с Pytorch\xa0'}, {'type': 'emoji', 'name': 'pytorch'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'опыт решения NLP / CV задач'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'навыки решения задач с помощью графов\xa0'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Мы предлагаем:', 'style': {'bold': True}}, {'type': 'text', 'text': '\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Разнообразные и интересные задачи в области математического моделирования, связанные с бизнес-результатом'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Возможности для саморазвития: оплата курсов популярных платформ, обучение за счёт компании'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Социальный пакет (ДМС, НПФ, льготные путевки)'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Бесплатный спортзал\xa0'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Место работы – БЦ Президент Плаза (м. Кутузовская) / удаленный режим работы из г. Москва'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\nРезюме присылайте на почту\xa0'}, {'type': 'link', 'url': 'mailto:AIgLitvintsev@sberbank.ru', 'text': 'AIgLitvintsev@sberbank.ru'}]}]}], 'text': 'Всем привет!\nКомпания:\xa0Сбер\xa0:sber_new:, Управление моделирования и исследования данных Блока Сеть продаж\nПозиция:\xa0Data Scientist\nУровень:\xa0Middle / Senior\nВилка:\xa0150-250 gross + годовая премия (x4-x9 окладов)\nМесто:\xa0Москва\xa0:default-city:, м. Кутузовская\n\nВам предстоит заниматься анализом геоданных, профилей клиентов, данных по транзакциям клиентов в системах Банка в масштабах всей страны, разрабатывать модели развития сети отделений и банкоматов, прогнозирования оттока клиентов и др.\n\xa0\nЗадачи:\n• проверка гипотез, проведение А/В тестирования\n• работа с геоданными, данными по транзакциям клиентов\n• разработка ML-моделей\n• участие в валидации модели\n• доработка модели на основании фактических результатов пилота\n• перевод модели в production\nТребования:\n• понимание принципов работы алгоритмов машинного обучения (линейная регрессия, логистическая регрессия, деревья решений, случайный лес, градиентный бустинг)\n• понимание математической статистики\n• опыт разработки в ML-проектах\n• уверенное владение SQL\xa0:sql:\n• опыт работы с sklearn\xa0:sklearn:, pandas, numpy, scipy, matplotlib\n• уверенное владение python\xa0:python:, ООП, git\xa0:git:\nБудет плюсом:\n• знание Deep Learning, oпыт работы с Pytorch\xa0:pytorch:\n• опыт решения NLP / CV задач\n• навыки решения задач с помощью графов\xa0\nМы предлагаем:\n• Разнообразные и интересные задачи в области математического моделирования, связанные с бизнес-результатом\n• Возможности для саморазвития: оплата курсов популярных платформ, обучение за счёт компании\n• Социальный пакет (ДМС, НПФ, льготные путевки)\n• Бесплатный спортзал\xa0\n• Место работы – БЦ Президент Плаза (м. Кутузовская) / удаленный режим работы из г. Москва\n\nРезюме присылайте на почту\xa0<mailto:AIgLitvintsev@sberbank.ru|AIgLitvintsev@sberbank.ru>', 'permalink': 'https://opendatascience.slack.com/archives/C04DA5FUF/p1612386189298500?thread_ts=1612386189.298500'}, {'iid': '6db1577a-72b5-4512-a4ce-28bb331bc764', 'team': 'T040HKJE3', 'channel': {'id': 'C04N3UMSL', 'is_channel': True, 'is_group': False, 'is_im': False, 'name': 'nlp', 'is_shared': False, 'is_org_shared': False, 'is_ext_shared': False, 'is_private': False, 'is_mpim': False, 'pending_shared': [], 'is_pending_ext_shared': False}, 'type': 'message', 'user': 'U6SEVHVG9', 'username': 'ilya_l', 'ts': '1548096930.623300', 'text': 'Всем привет!\n\nЕсть ли у кого-нибудь опыт решения любых NLP задач на арабском языке?\nПодскажите, какие подводные камни существуют в этом языке при сравнении с русским и английским? Какие стандартные NLP подходы не работают?\nИнтересуют вообще любые проблемы / сложности, с которыми вы сталкивались, любой опыт, когда вы пробовали завести для арабского языка то, что работало на других языках.\nОчевидно, что для таких задач необходимо привлекать переводчиков, арабоговорящих DS, размечать новые данные на арабском и т.д. Различные статьи про NLP на арабском и про базовые особенности я уже почитал, но хочется услышать про что-то, что не лежит на поверхности от тех, у кого был соответствующий опыт.\n\nСпасибо!', 'permalink': 'https://opendatascience.slack.com/archives/C04N3UMSL/p1548096930623300?thread_ts=1548096930.623300', 'no_reactions': True}, {'iid': 'b6e2a091-9b87-42b7-b405-75f3088c822e', 'team': 'T040HKJE3', 'channel': {'id': 'C04DA5FUF', 'is_channel': True, 'is_group': False, 'is_im': False, 'name': '_jobs', 'is_shared': False, 'is_org_shared': False, 'is_ext_shared': False, 'is_private': False, 'is_mpim': False, 'pending_shared': [], 'is_pending_ext_shared': False}, 'type': 'message', 'user': 'U83Q16FHC', 'username': 'artem_bochkarev', 'ts': '1596718121.185700', 'blocks': [{'type': 'rich_text', 'block_id': 'FBf1', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Компания OZON\xa0'}, {'type': 'emoji', 'name': 'ozon'}, {'type': 'text', 'text': '\n'}, {'type': 'emoji', 'name': 'default-city'}, {'type': 'text', 'text': '\xa0Москва (офис на 42 этаже в Москва-Сити)\n'}, {'type': 'emoji', 'name': 'hourglass_flowing_sand'}, {'type': 'text', 'text': '\xa0Фултайм\n'}, {'type': 'emoji', 'name': 'widefork'}, {'type': 'text', 'text': '\xa0150-300 т.р.\n\nИщем миддла/сеньора в команду, занимающуюся ранжированием в поиске и каталоге, а так же немного ad-hoc NLP, CV задач.\n\nТекущий стек технологий:\n'}, {'type': 'emoji', 'name': 'python'}, {'type': 'text', 'text': ',\xa0'}, {'type': 'emoji', 'name': 'hadoop'}, {'type': 'text', 'text': '\xa0(PySpark, Hive, HDFS),\xa0'}, {'type': 'emoji', 'name': 'pytorch'}, {'type': 'text', 'text': ',\xa0'}, {'type': 'emoji', 'name': 'xgboost'}, {'type': 'text', 'text': ','}, {'type': 'emoji', 'name': 'catboost'}, {'type': 'text', 'text': ','}, {'type': 'emoji', 'name': 'lgbm'}, {'type': 'text', 'text': ','}, {'type': 'emoji', 'name': 'airflow'}, {'type': 'text', 'text': ',\xa0'}, {'type': 'emoji', 'name': 'dvc'}, {'type': 'text', 'text': ',\xa0'}, {'type': 'emoji', 'name': 'clickhouse'}, {'type': 'text', 'text': ','}, {'type': 'emoji', 'name': 'gitlab'}, {'type': 'text', 'text': ', grafana, streamlit\n\nПочему то, что мы делаем - интересно:\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Важные для бизнеса задачи. Поиск и каталог генерируют не меньше трети GMV Ozon, от наших моделей напрямую зависит как они работают'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Технически сложные задачи. Часть моделей работает в реалтайме, немалую часть продакшн кода мы пишем сами (не реалтайм), поэтому у нас в том числе есть много архитектурных задач. Для сбора датасетов и обучения моделей мы действительно можем и используем большие данные (только пользовательского взаимодействия накапливается по 300ГБ в день)'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Крутые ML задачи. У нас большая свобода в подходах к решению задач, мы читаем новые статьи и пытаемся внедрять в прод, если верим в успех по метрикам.'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\nПроекты, которыми мы занимаемся сейчас/хотим заниматься в ближайшее время:\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Нейросетевой поиск (как фильтрация для ранжирования и как фича), он же DSSM'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Устранение positional bias при ранжировании в поиске и каталоге (товар выше имеет больший шанс быть кликнутым вне зависимости от релевантности\xa0'}, {'type': 'emoji', 'name': 'genious'}, {'type': 'text', 'text': ')'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Построение бизнесовых оффлайн метрик, которые хорошо коррелируют с результатами аб тестов'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Multi-objective ranking'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Автоматическая модерация отзывов на мат/неинформативность итд'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Бесконечное внедрение новых фичей в ранжирование'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Бесконечные улучшение перфоманса и архитектуры ранжирования'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\nЧто мы ожидаем:\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Хорошее знание Python'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Опыт решения DS задач в бизнесе от 1 года'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Наличие фундаментальной математической базы, алгоритмы'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Знание и опыт работы на практике с большей частью нашего стека технологий'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Бодрость духом и желание решать сложные задачи\xa0'}, {'type': 'emoji', 'name': 'smiley'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\nРезюме и вопросы можно в личку\xa0'}, {'type': 'emoji', 'name': 'slightly_smiling_face'}]}]}], 'text': 'Компания OZON\xa0:ozon:\n:default-city:\xa0Москва (офис на 42 этаже в Москва-Сити)\n:hourglass_flowing_sand:\xa0Фултайм\n:widefork:\xa0150-300 т.р.\n\nИщем миддла/сеньора в команду, занимающуюся ранжированием в поиске и каталоге, а так же немного ad-hoc NLP, CV задач.\n\nТекущий стек технологий:\n:python:,\xa0:hadoop:\xa0(PySpark, Hive, HDFS),\xa0:pytorch:,\xa0:xgboost:,:catboost:,:lgbm:,:airflow:,\xa0:dvc:,\xa0:clickhouse:,:gitlab:, grafana, streamlit\n\nПочему то, что мы делаем - интересно:\n• Важные для бизнеса задачи. Поиск и каталог генерируют не меньше трети GMV Ozon, от наших моделей напрямую зависит как они работают\n• Технически сложные задачи. Часть моделей работает в реалтайме, немалую часть продакшн кода мы пишем сами (не реалтайм), поэтому у нас в том числе есть много архитектурных задач. Для сбора датасетов и обучения моделей мы действительно можем и используем большие данные (только пользовательского взаимодействия накапливается по 300ГБ в день)\n• Крутые ML задачи. У нас большая свобода в подходах к решению задач, мы читаем новые статьи и пытаемся внедрять в прод, если верим в успех по метрикам.\n\nПроекты, которыми мы занимаемся сейчас/хотим заниматься в ближайшее время:\n• Нейросетевой поиск (как фильтрация для ранжирования и как фича), он же DSSM\n• Устранение positional bias при ранжировании в поиске и каталоге (товар выше имеет больший шанс быть кликнутым вне зависимости от релевантности\xa0:genious:)\n• Построение бизнесовых оффлайн метрик, которые хорошо коррелируют с результатами аб тестов\n• Multi-objective ranking\n• Автоматическая модерация отзывов на мат/неинформативность итд\n• Бесконечное внедрение новых фичей в ранжирование\n• Бесконечные улучшение перфоманса и архитектуры ранжирования\n\nЧто мы ожидаем:\n• Хорошее знание Python\n• Опыт решения DS задач в бизнесе от 1 года\n• Наличие фундаментальной математической базы, алгоритмы\n• Знание и опыт работы на практике с большей частью нашего стека технологий\n• Бодрость духом и желание решать сложные задачи\xa0:smiley:\n\nРезюме и вопросы можно в личку\xa0:slightly_smiling_face:', 'permalink': 'https://opendatascience.slack.com/archives/C04DA5FUF/p1596718121185700?thread_ts=1596718121.185700'}, {'iid': '931ee973-d2c2-4f17-abe0-990aff5d8e8f', 'team': 'T040HKJE3', 'channel': {'id': 'C04DA5FUF', 'is_channel': True, 'is_group': False, 'is_im': False, 'name': '_jobs', 'is_shared': False, 'is_org_shared': False, 'is_ext_shared': False, 'is_private': False, 'is_mpim': False, 'pending_shared': [], 'is_pending_ext_shared': False}, 'type': 'message', 'user': 'U4CUQ0BK8', 'username': 'paddler', 'ts': '1590590838.386600', 'blocks': [{'type': 'rich_text', 'block_id': 'vhdo', 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Всем привет! Кому передать эстафетную палочку?)\n\n'}, {'type': 'text', 'text': 'Позиция', 'style': {'bold': True}}, {'type': 'text', 'text': ': Head of ML\n'}, {'type': 'text', 'text': 'Компания:\xa0', 'style': {'bold': True}}, {'type': 'text', 'text': 'ЦИАН\n'}, {'type': 'text', 'text': 'Город:\xa0', 'style': {'bold': True}}, {'type': 'text', 'text': 'Москва\xa0\n\n'}, {'type': 'text', 'text': 'Задачи:', 'style': {'bold': True}}, {'type': 'text', 'text': '\n\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Анализ применимости новых технологий к деятельности компании, оценка возможного эффекта;'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Развивать существующие направлений: антифрод в объявлениях (работа с аудио, speachtotext, cv), рекомендательные сервисы, персональное ранжирование, блокировка парсеров;'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Развивать data платформы, по сбору, упорядочению данных, соблюдение целостности и адекватности данных, обеспечение простого и быстрого доступа к данным и принятия решений на основе данных;'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Выстраивать взаимодействие с другими подразделениями - продукт, разработка, BI, продажи, CRM;'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Выстраивать процессы внутри направления, рост эффективности (развитие команды, работа со стримами, расстановка приоритетов, декомпозиция задач);'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Прорабатывать стратегию развития направления и ее защита;'}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Краткосрочное и долгосрочное планирование работы направления.'}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\n\n'}, {'type': 'text', 'text': 'Человек на этой позиции:', 'style': {'bold': True}}, {'type': 'text', 'text': '\n\n'}]}, {'type': 'rich_text_list', 'style': 'bullet', 'indent': 0, 'elements': [{'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Имеет успешный опыт опыт организации и руководства команды ML;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Имеет глубокое знание методов машинного обучения и способов проверки корректности работы моделей: xgboost/lightgbm, tensorflow/pytorch, fasttext/w2v;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Имеет опыт работы с Spark, Hive, Hadoop, Sql;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Умеет собирать выборки из сырых данных;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Отлично знает Python (включая Numpy, Networkx, Scikit-Learn, Pandas, Matplotlib, Seaborn);', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Имеет опыт работы с изображениями (нейросети, Deep Learning), опыт работы с NLP, TimeSeries;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Способен понимать бизнес задачу и переводить ее на математический язык, предлагать решения на основе данных;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Умеет строить модели машинного обучения и выводить их в прод;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Умеет проводить A/B тестирование, оценивать эффективность решений;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Умеет работать с людьми, понимать их мотивацию, владеть различными стилями лидерства, быть ментором и наставником;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Имеет опыт выстраивания процессов обучения и роста сотрудников;', 'style': {'bold': True}}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': 'Умеет находить в конфликтных ситуациях win/win решения;', 'style': {'bold': True}}]}]}, {'type': 'rich_text_section', 'elements': [{'type': 'text', 'text': '\n\n'}, {'type': 'text', 'text': 'ЗП ожидания:\xa0', 'style': {'bold': True}}, {'type': 'text', 'text': 'от 400 тыс. руб. до 600 тыс. руб. на руки\n\nСобеседование включает тестовое задание/техническое интервью.\n\nРезюме присылать сюда:\xa0'}, {'type': 'link', 'url': 'mailto:a.krashevskaya@cian.ru', 'text': 'a.krashevskaya@cian.ru'}, {'type': 'text', 'text': '\xa0(edited)'}]}]}], 'text': 'Всем привет! Кому передать эстафетную палочку?)\n\nПозиция: Head of ML\nКомпания:\xa0ЦИАН\nГород:\xa0Москва\xa0\n\nЗадачи:\n\n• Анализ применимости новых технологий к деятельности компании, оценка возможного эффекта;\n• Развивать существующие направлений: антифрод в объявлениях (работа с аудио, speachtotext, cv), рекомендательные сервисы, персональное ранжирование, блокировка парсеров;\n• Развивать data платформы, по сбору, упорядочению данных, соблюдение целостности и адекватности данных, обеспечение простого и быстрого доступа к данным и принятия решений на основе данных;\n• Выстраивать взаимодействие с другими подразделениями - продукт, разработка, BI, продажи, CRM;\n• Выстраивать процессы внутри направления, рост эффективности (развитие команды, работа со стримами, расстановка приоритетов, декомпозиция задач);\n• Прорабатывать стратегию развития направления и ее защита;\n• Краткосрочное и долгосрочное планирование работы направления.\n\n\nЧеловек на этой позиции:\n\n• Имеет успешный опыт опыт организации и руководства команды ML;\n• Имеет глубокое знание методов машинного обучения и способов проверки корректности работы моделей: xgboost/lightgbm, tensorflow/pytorch, fasttext/w2v;\n• Имеет опыт работы с Spark, Hive, Hadoop, Sql;\n• Умеет собирать выборки из сырых данных;\n• Отлично знает Python (включая Numpy, Networkx, Scikit-Learn, Pandas, Matplotlib, Seaborn);\n• Имеет опыт работы с изображениями (нейросети, Deep Learning), опыт работы с NLP, TimeSeries;\n• Способен понимать бизнес задачу и переводить ее на математический язык, предлагать решения на основе данных;\n• Умеет строить модели машинного обучения и выводить их в прод;\n• Умеет проводить A/B тестирование, оценивать эффективность решений;\n• Умеет работать с людьми, понимать их мотивацию, владеть различными стилями лидерства, быть ментором и наставником;\n• Имеет опыт выстраивания процессов обучения и роста сотрудников;\n• Умеет находить в конфликтных ситуациях win/win решения;\n\n\nЗП ожидания:\xa0от 400 тыс. руб. до 600 тыс. руб. на руки\n\nСобеседование включает тестовое задание/техническое интервью.\n\nРезюме присылать сюда:\xa0<mailto:a.krashevskaya@cian.ru|a.krashevskaya@cian.ru>\xa0(edited)', 'permalink': 'https://opendatascience.slack.com/archives/C04DA5FUF/p1590590838386600?thread_ts=1590590838.386600'}]
        ind_list = [get_ind(match) for match in matches]
        self.assertEqual(ind_list, ['UED0HP6KG_1612386189.0', 'U6SEVHVG9_1548096930.0', 'U83Q16FHC_1596718121.0', 'U4CUQ0BK8_1590590838.0'])


if __name__ == '__main__':
    unittest.main()
